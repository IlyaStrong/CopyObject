**Copy Object**

Коллеги, в этом репозитории программа Copy Object со всеми исходниками.
Программа на чистом python, при том что exeшник запускается на любом ПК, где даже не установлен python.
Достаточно скачать и запустить. 
В директории "source" располагаются все исходники, в "scripts" отдельно python скрипты, в архиве "Copy Object" лежит собранный exe файл,
который представляет из себя полноценную программу с UI интерфейсом.
Для чего это было сделано и как этим пользоваться? 

У меня очень часто возникали задачи, когда трубуется взять 50, 100 или 500 названий объектов с третьей скады,
идущих списком и вставить имена в объекты четвёртой. По скольку, используя скрипты, в проект скады мы залезть не можем, 
т.к. корень проекта цельный файл и меняется каждый раз следовательно это примитивное действие приходится выполнять 
в ручную, кликая по экрану и нажимая ctrl C ctrl V. Если список действительно велик, на это и целый день может уйти,
причём далеко не факт что в ручную это выполнится корректно с первого раза.

Скрипт работает следующим образом:
1) Получает координаты первых объектов с кликов мыши. Один клик - откуда начнём копирование, второй клик - куда. 
2) Получает количество элементов, которые требуется скопировать с нашего ввода.
3) Делает клик в исходное окно
4) Нажимает f2, чтобы провалиться в название и скопировать
5) ctrl C
6) Делает клик в окно, в которое копируем
7) снова f2
8) ctrl V

Это копирование производится последовательно, спускаясь вниз по списку до указанного числа элементов.
Работает не только на скаде - копирует откуда угодно, что угодно.
Координаты он получает только на первой итерации. **Пока происходит копирование мы не должны трогать мышь!**
**До запуска exe обязательно поставьте англ раскладку иначе не сработает, т.к. это python.**

Если вам требуется простое копирование запускаем exe файл и просто нажимаем старт.
Если имена объектов идут не подряд, а с каким-то шагом, нажимаете Chek Box "Шаг".
При этом скрипт попросит у вас ввести шаг для каждого окна, независимый друг от друга и будет
производить копирование пропуская указанное количество объектов.
Перед самым стартом, когда вам выводится сообщение "Переключитесь на оба объекта и
подготовьтесь к копированию" нужно нажать на оба окна несколько раз,
т.к. скрипт переключает экраны комбинацией alt + Tab. Если этого не сделать, он может 
при копировании даже используя верные координаты подставлять не в то окно. 
**Программа в любой момент останавливается нажатием Esc**, если вдруг это потребовалось.

Также в программе есть возможность копировать строки с Exel. Я этим пользуюсь, когда требуется
брать наименования из ТБ. У нас часто в ТБ строки склеены, на этот случай в скрипте прописано, как с них считывать.
Если мы хотим этим воспользоваться, то нам требуется сделать несколько
дополнительных действий:
1) Активироать Check Box "Exel"
2) Указать номер листа
3) Указать номер столбца откуда берём строки для копирования
В UI это всё достаточно понятно.

Иногда просто требуется скопировать из одного места и вставить в другое, на этот
случай есть Check Box "Отключить f2".

**Об ограничениях**
1) Шаг в Exel к сожалению не работает, проще сам лист эксель отредактировать и запустить так как требуется,
либо открыть exel как программу и запустить скрипт с шагом, отключив f2 только на первом экране.
2) Копирование ограничивается размерами экрана, т.к. на каждой итерации первый клик приходится в первый элемент
и до необходимого объекта скрипт добирается нажатием стрелки вниз. Это ограничение пока не получается убрать, т.к.
в python нет возможности считать координаты выделенного объекта, при том что мышь где то в другом месте.
Читает только координаты мыши.
3) Работает только при установки англ расклакди до запуска exe. 

При первом запуске возможно потребуется добавить exe в исключения защитника windows. Если показывает, 
что там троян - там нет трояна.
Кладу скрипты без UI в отдельную папку, чтобы в любой момент можно было легко что-то изменить,
добавить и запустить из консоли. Например, если делать такое же копирование из modbus, адресов или устройств,
то там недостаточно нажать f2 чтобы выделить название. У меня на такой случай есть скрипт, в котором дополнительно
прописано после f2 ctrl A (выделить всё) и только потом ctrl + C. 
Чтобы добавить действий для каких-либо других задач нужно лишь изменить
вот эти две функции. Код библиотеки pyautogui крайне читаем и понятен.

```
 def perform_actions1(coord1, i, step1):
    pyautogui.moveTo(coord1)
    pyautogui.click()
    pyautogui.press('down', presses=i*step1)
    pyautogui.press('f2')
    pyautogui.hotkey('ctrl', 'c')
    pyautogui.hotkey('alt', 'tab')

def perform_actions2(coord2, i, step2):
    pyautogui.moveTo(coord2)
    pyautogui.click()
    pyautogui.press('down', presses=i*step2)
    pyautogui.press('f2')
    pyautogui.hotkey('ctrl', 'v')
    pyautogui.press('enter')
    pyautogui.hotkey('alt', 'tab')   
```


